### 해싱

- 키 값에 직접적인 산술적인 연산을 적용하여 항목이 저장되어있는 테이블의 주소를 계산하여 항목에 접근
- **어떤 항목의 탐색키만을 가지고, 바로 항목이 저장되어있는 배열의 인덱스를 결정하는 방법**
- 키 값의 연산에 의해 직접접근이 가능한 구조를 해시테이블이라고 함
- 해시테이블을 이용한 탐색을 해싱이라고 함
- **키들의 비교에 의한 탐색방법은, 정렬이 안되어있을 경우 O(n)이고, 정렬이 되어 있으면 O(log2n)**

### 해싱의 구조

- 해싱을 위한 사전구조는 키-값 구조
- 해싱은 자료를 저장하는데 배열을 사용
- 이때 탐색 키는 보통 문자열이거나 매우 큰 숫자이기 때문에 탐색 키를 직접 배열의 인덱스로 사용하기에는 무리가 있으므로, 각 탐색키를 작은 정수로 사상(매핑)시키는 어떤 함수가 필요함
- **해시함수**란, 탐색키를 입력으로 받아 **해시주소**를 생성하고, 이 해시주소가 배열로 구현된 **해시테이블**의 인덱스가 됨
- 해시테이블에는 M개의 버켓이 있으며, 하나의 버켓은 S개의 슬롯을 가질 수 있고, 하나의 슬롯에는 하나의 항목이 저장됨. 그러나, 대부분 하나의 버켓은 하나의 슬롯을 가짐

### 해싱 오버플로

- 해시테이블의 버켓 수는 키가 가질 수 있는 모든 경우의 수보다 매우 작기 때문에, 여러개의 서로 다른 탐색키가 해시함수에 의해 같은 해시주소로 사상되는 경우가 자주 발생
- 서로 다른 두개의 탐색키 K1과 K2에 대하여 해시테이블h(k1)=h(k2)인 경우를 충돌(collosion)이라고 함
- 충돌이 자주 발생하면 버켓 내부에서의 순차탐색시간이 길어져서 탐색성능이 저하될 수 있음
- 충돌이 버켓에 할당된 슬롯 수보다 많이 발생하게되면 버켓에 더이상 항목을 저장할 수 없게 되는 오버플로우가 발생

---

### 해시함수

- 충돌이 적어야하고, 해시함수값이 테이블의 주소영역내에서 고르게 분포되어야하며, 계산이 빨라야 함

---

### 해시함수의 종류

---

### 1. 제산함수

- 나머지연산자(mod)를 사용하여, 탐색키를 해시테이블의 크기로 나눈 나머지를, 해시주소로 사용하는 방법
- h(k) = K mod M
- 해시테이블의 크기 M은 소수로 나누어지지 않는 수로 선택함.
- 또한, 테이블의 크기 M은 항상 홀수여야 함.
- 나머지 연산 수행 시, 음수가 나올 가능성도 대비해야함 (음수라면 그 값에 M을 더해주기)

### 2. 폴딩함수

- 탐색키를 여러부분으로 나누어 모두 더한 값을 해시주소로 사용
- 탐색키를 나누고 더하는 방법에는 이동폴딩과 경계폴딩이 대표적
- 이동폴딩 : 탐색키를 여러부분으로 나눈 값들을 더하여 해시주소로 사용
- 경계폴딩 : 탐색키의 이웃한 부분을 거꾸로 더하여 해시주소를 얻음
- 키 값을 해시테이블 크기만큼의 수를 가지는 부분으로 분할한 후, 분할된 부분을 합하여 해시주소를 만들어줌
- 폴딩함수는 주로 탐색키가 해시테이블의 크기보다 더 큰 정수일 경우에 사용됨
- **탐색키를 몇개의 부분으로 나누어 이를 더하거나 비트별로 XOR같은 부울 연산을 하는 것이 훨씬 바람직함. 이것을 폴딩이라고 함**

### 3. 중간제곱함수

- **탐색키를 제곱한 다음, 중간의 몇 비트를 취해서 해시주소를 생성**
- 제곱한 값의 중간비트들은 대개 탐색키의 모든 문자들과 관련있기 때문에, 서로 다른 탐색키는 몇개의 문자가 같을지라도 서로 다른 해싱주소를 갖게 됨
- **탐색키 값을 제곱한 값의 중간비트들의 값은 대부분 고르게 분산됨**

### 4. 비트추출방법

- **해시테이블의 크기가 M=2의 k제곱일 때, 탐색키를 이진수로 간주하여 임의의 위치의 k개의 비트를 해시주소로 사용하는 것**
- 아주 간단하지만, **탐색키의 일부 정보만을 사용하므로 해시주소의 집중현상**이 일어날 가능성이 높음

### 5. 숫자분석방법

- 숫자로 구성된 키에서 각각의 위치에 있는 수의 특징을 미리 알고 있을 때 유용함
- **키의 각각의 위치에 있는 숫자 중에서, 편중되지 않은 수들을, 해시테이블의 크기에 적합한 만큼 조합하여 해시주소로 사용하는 방법**
- ex) 학번이 200812345라고 한다면, 앞의 2008년도를 의미하는 4자리 수는 편중되어 있으므로 가급적 사용하지 않고, 나머지 수를 조합하여 해시주소로 사용

---

### 충돌의 해결책

- 충돌 : 서로 다른 탐색 키를 갖는 항목들이, 같은 해시주소를 가지는 현상
- 해결책으로는 선형조사법과 체이닝이 있음

---

### 1. 선형조사법 (linear probing)

- **특정 버켓에서 충돌이 발생하면, 해시테이블에서 현재 사용되지 않는 비어있는 버켓을 찾아 위치시키는 방**법
- 해시테이블에서 비어있는 공간을 찾는 것을 조사(probing)라고 함
- **만약, h[k]에서 충돌이 발생했으면, h[k+1]이 비어있는지 찾고, 안비어있으면 h[k+2] 이런식으로 계속 비어있는 공간이 나올 때까지 계속해서 조사하는 방법**
- 테이블의 끝에 도달하게 되면, 다시 테이블의 처음으로 감
- 조사를 시작했던 곳으로 다시 되돌아오게 되면 테이블이 가득찬 것이 됨
- **간단하다는 장점이 있지만, 오버플로우가 자주 발생하면 집중과 결함에 의해 탐색의 효율이 크게 저하될 수 있음**
- 군집화현상 : 한번 충돌이 발생하면, 그 위치에 항목들이 집중되는 현상

### 1.1 이차조사법

- **선형조사법의 문제점인 집중과 결함을 크게 완화**시킬 수 있음

### 1.2 이중해싱법 또는 재해싱

- **오버플로우가 발생함에 따라, 항목을 저장할 다음 위치를 결정할 때, 원래 해시함수와 다른 별개의 해시함수를 이용하는 방법**
- 선형조사법은 충돌 발생 시 1을 더하며 위치를 찾아가고, 이차조사법은 t의2을 더해가며 위치를 찾아감
- **이중해싱법은 충돌 발생 시, 탐색키를 참조하여 더해지는 값이 결정됨**
- **따라서, 함수값이 같더라도 탐색키가 다르면 서로 다른 조사순서를 가짐**

---

### 2. 체이닝

- 충돌 발생 시, **해시테이블의 구조를 변경하여 각 버켓이 하나 이상의 값을 저장할 수 있도록 함**
- 오버플로우 문제를 **연결리스트를 통해 해결함**
- 체이닝에서 항목을 탐색하거나 삽입하고자 하면, 키 값의 버켓에 해당하는 연결리스트에서 독립적으로 탐색이나 삽입이 이루어짐
- 해시테이블을 연결리스트로 구성하므로, 필요한 만큼의 메모리만 사용하게 되어  공간적 사용 효율이 매우 우수함
- 또한, 오버플로우가 발생할 경우에도, 해당 버켓에 할당된 연결리스트만 처리하게 되므로 수행시간 면에서도 매우 효율적
